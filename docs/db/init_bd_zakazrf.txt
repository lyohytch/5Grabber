drop database zakazrf;
create database zakazrf;
connect zakazrf;

CREATE TABLE Reduction(
    id_reduction MEDIUMINT UNSIGNED NOT NULL,
    string_number VARCHAR(20) NOT NULL,
    id_customer MEDIUMINT UNSIGNED NOT NULL,
    date_registration VARCHAR(100),
    url VARCHAR(150),
    last_parsed DATETIME,
    PRIMARY KEY (id_reduction)
);

CREATE TABLE Lot (
    id_reduction MEDIUMINT UNSIGNED NOT NULL,
    num_lot SMALLINT UNSIGNED NOT NULL,
    id_lot MEDIUMINT UNSIGNED,
    url VARCHAR(150),
    status SMALLINT UNSIGNED NOT NULL,
    subject VARCHAR(1000),  
    obespechenie VARCHAR(150),
    start_price FLOAT,
    best_price VARCHAR(50),
    start_time DATETIME,
    end_time DATETIME,
    winner VARCHAR(300),
    protocol VARCHAR(150),
    protocol_summary VARCHAR(150),
    last_parsed DATETIME,
    PRIMARY KEY (id_lot, id_reduction)
);

CREATE TABLE Customer (
    id_customer MEDIUMINT UNSIGNED NOT NULL UNIQUE,
    name VARCHAR(300),
    adress VARCHAR(400),
    post_adress VARCHAR(400),
    email VARCHAR(100),
    telephone VARCHAR(100),
    PRIMARY KEY (id_customer)
);

CREATE TABLE Party (
    id_party_auto MEDIUMINT UNSIGNED NOT NULL UNIQUE AUTO_INCREMENT UNIQUE,
    id_lot MEDIUMINT UNSIGNED NOT NULL UNIQUE,
    id_participant MEDIUMINT UNSIGNED NOT NULL UNIQUE,
    PRIMARY KEY (id_party_auto)
);

CREATE TABLE Participant (
    id_participant MEDIUMINT UNSIGNED NOT NULL UNIQUE AUTO_INCREMENT UNIQUE,
    name VARCHAR(300),
    inn VARCHAR(30),
    kpp VARCHAR(30),
    id_reduction MEDIUMINT UNSIGNED NOT NULL,
    num_lot SMALLINT UNSIGNED NOT NULL,
    PRIMARY KEY (id_participant)
);

CREATE TABLE Status (
    id_status SMALLINT UNSIGNED NOT NULL UNIQUE,
    status VARCHAR(30),
    PRIMARY KEY (id_status)
);

CREATE TABLE DocFile (
    id_file MEDIUMINT UNSIGNED NOT NULL UNIQUE,
    id_reduction MEDIUMINT UNSIGNED NOT NULL,
    num_lot SMALLINT UNSIGNED NOT NULL,
    name VARCHAR(256),
    url VARCHAR(300),
    uploaded DATETIME,
    last_parsed DATETIME,
    info VARCHAR(5000),
    PRIMARY KEY (id_file)
);

CREATE TABLE Auction (
    id_auction MEDIUMINT UNSIGNED NOT NULL UNIQUE,
    code VARCHAR(30),
    url VARCHAR(150),
    subject VARCHAR(500),
    customer_name VARCHAR(300),
    customer_address VARCHAR(300),
    customer_post VARCHAR(300),
    customer_email VARCHAR(100),
    customer_phone VARCHAR(50),
    customer_contact VARCHAR(100),
    auctionbegindate DATETIME,
    auctionenddate DATETIME,
    publicdate DATETIME,
    requestacceptdate DATE,
    requestdate DATETIME,
    purchamount FLOAT,
    contrcoveramount FLOAT,
    contrcoveramountinpercent SMALLINT UNSIGNED,
    contrneed CHAR(3),
    status VARCHAR(20),
    winner VARCHAR(150),
    protocol VARCHAR(100),
    last_parsed DATETIME,
    PRIMARY KEY (id_auction)
);

SHOW TABLES;